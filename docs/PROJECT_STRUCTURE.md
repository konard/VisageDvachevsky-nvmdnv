# Структура проекта NovelMind

Этот документ описывает стандартную структуру каталогов для проектов визуальных новелл NovelMind.

## Стандартная структура проекта

```
MyProject/
├── project.json           # Конфигурация проекта и метаданные
├── .gitignore             # Исключения системы контроля версий
│
├── Assets/                # Все ресурсы проекта
│   ├── Images/            # Изображения (фоны/персонажи/UI/эффекты)
│   ├── Audio/             # Музыка/звуки/озвучка
│   └── Fonts/             # Шрифты
│
├── Scripts/               # Исходные файлы NM Script
│   ├── main.nms           # Точка входа скрипта
│   ├── characters.nms     # Определения персонажей
│   ├── scenes/            # Скрипты сцен
│   └── common/            # Общие скрипты
│
├── Scenes/                # Файлы данных сцен
│
├── Localization/          # Файлы локализации
│   ├── en.json            # Английские строки
│   └── templates/         # Шаблоны перевода
│
├── Docs/                  # Документация проекта (опционально)
│
└── Build/                 # Результаты сборки (игнорируются VCS)
    ├── debug/
    └── release/
```

## Описание каталогов

### `/project.json`

Файл конфигурации проекта, содержащий:

```json
{
    "name": "My Visual Novel",
    "version": "1.0.0",
    "author": "Author Name",
    "description": "A compelling visual novel...",
    "startScene": "prologue",
    "defaultResolution": {
        "width": 1920,
        "height": 1080
    },
    "locales": ["en", "ja"],
    "defaultLocale": "en",
    "nmScriptVersion": "1.0"
}
```

### `/Assets/`

Содержит все медиа-ресурсы, используемые проектом.

**Рекомендации по организации:**
- Используйте подкаталоги для группировки связанных ресурсов
- Используйте описательные имена в нижнем регистре с подчеркиваниями
- Храните ресурсы персонажей в папках с именами персонажей
- Файлы озвучки должны соответствовать соглашениям именования строк диалога

**Поддерживаемые форматы:**
- Изображения: PNG, JPEG, WebP
- Аудио: OGG, WAV, MP3, FLAC
- Шрифты: TTF, OTF

### `/Scripts/`

Содержит исходные файлы NM Script.

**Рекомендации по организации:**
- `main.nms` является точкой входа
- Группируйте скрипты сцен по главам или разделам истории
- Храните общие/утилитарные скрипты в `common/`
- Определения персонажей могут быть централизованными или разделены по главам

### `/Localization/`

Содержит файлы локализации для многоязычной поддержки.

**Рекомендации по организации:**
- Один файл на локаль (например, `en.json`, `ja.json`)
- Используйте коды языков ISO 639-1
- Храните файлы шаблонов для переводчиков

**Формат файла:**
```json
{
    "greeting": "Hello!",
    "farewell": "Goodbye!",
    "item_count_one": "{count} item",
    "item_count_other": "{count} items"
}
```

### Дополнительные каталоги (опционально)

Проект может содержать дополнительные папки для внутренних данных студии
или пользовательских файлов, но редактор опирается на стандартные каталоги.

### `/Build/`

Каталог вывода сборки. **Всегда игнорируется системой контроля версий.**

Содержит:
- Скомпилированные скрипты
- Упакованные ресурсы
- Финальные исполняемые файлы

## Соглашения об именовании ресурсов

### Фоны

```
location_variant_time.png

Примеры:
school_classroom_day.png
school_classroom_night.png
park_fountain.png
```

### Спрайты персонажей

```
character/expression_pose.png

Примеры:
hero/happy_standing.png
hero/sad_sitting.png
sidekick/neutral_default.png
```

### Файлы озвучки

```
character_lineId.ogg

Примеры:
hero_001_greeting.ogg
narrator_intro_001.ogg
sidekick_ch1_045.ogg
```

Распознавание паттернов поддерживает:
- `{character}_{id}.{ext}`
- `{character}_{number}_{description}.{ext}`
- `{scene}_{character}_{line}.{ext}`

### Музыка

```
type_name.ogg

Примеры:
bgm_main_theme.ogg
bgm_battle.ogg
bgm_sad_moment.ogg
```

### Звуковые эффекты

```
category_name.ogg

Примеры:
ui_click.ogg
sfx_door_open.ogg
ambient_rain.ogg
```

## Лучшие практики контроля версий

### Файлы для включения

- Все исходные скрипты (`.nms`)
- Файлы локализации (`.json`, `.csv`, `.po`)
- Конфигурация проекта (`project.json`)
- Документация (`/docs/`)
- Исходные файлы ресурсов (изображения, аудио)

### Файлы для исключения

Используйте предоставленный шаблон `.gitignore` для исключения:

- Результаты сборки (`/Build/`)
- Кэш редактора (`.nmcache/`)
- Миниатюры и превью
- Файлы логов
- Локальная конфигурация
- Специфичные для ОС файлы
- Конфигурация IDE

## Рабочий процесс с несколькими разработчиками

### Стратегия ветвления

```
main              # Стабильные релизы
├── develop       # Ветка интеграции
│   ├── feature/* # Ветки функций
│   └── fix/*     # Ветки исправлений
└── release/*     # Подготовка релиза
```

### Обработка ресурсов

Для больших бинарных ресурсов:
- Рассмотрите Git LFS для файлов озвучки и музыки
- Используйте наборы ресурсов для распространения в команде
- Документируйте владение/ответственность за ресурсы

### Конфликты слияния

Распространенные источники конфликтов:
- Изменения версии в `project.json`
- Добавление строк локализации
- Модификации скриптов

Разрешение:
- Предпочитайте инструменты слияния JSON для файлов данных
- Используйте модульную систему NM Script для уменьшения конфликтов
- Общайтесь о общих ресурсах

## Создание новых проектов

### Из шаблона

1. Откройте редактор NovelMind
2. File > New Project
3. Выберите шаблон:
   - Empty Project
   - Kinetic Novel
   - Branching Story
4. Выберите расположение
5. Настройте параметры проекта

### Ручная настройка

1. Создайте каталог проекта
2. Скопируйте `project.gitignore` как `.gitignore`
3. Создайте `project.json` с необходимыми полями
4. Создайте стандартные каталоги:
   - `Assets/`
   - `Scripts/`
   - `Localization/`
5. Добавьте точку входа `Scripts/main.nms`

## Миграция проекта

При миграции со старых версий:

1. Создайте резервную копию всего проекта
2. Откройте в новой версии редактора
3. Следуйте подсказкам миграции
4. Проверьте, что все ресурсы загружаются корректно
5. Протестируйте геймплей от начала до конца
6. Обновите версию в `project.json` при необходимости
